{"version":3,"file":"index.js","mappings":"4QAAA,IAAIA,EAAUC,YAAYC,mBAC1BC,QAAQC,cAAcC,aAAcC,IAC9BN,IAAYM,IACdN,EAAUM,EACVC,OAAOC,SAASC,W,WCHpBC,EAAE,KACAC,OAAOC,QAAQ,eAAgB,UAIjCF,EAAEH,QAAQM,GAAG,WAAY,KACvBF,OAAOG,KAAK,aAAc,Q,WCP5BX,QAAQC,cAAcW,gBAAkBC,IACtCL,OAAOM,MAAM,UAAUD,WAAqB,S,WCD9CN,EAAE,KACAQ,qBAAqB,CAAC,CAAEC,KAAM,MAAOC,SAAS,KAE9CjB,QAAQkB,eAAe,OAAQ,KAC7BV,OAAOW,QAAQ,a,GCHfC,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaE,QAGrB,IAAIC,EAASN,EAAyBE,GAAY,CAGjDG,QAAS,CAAC,GAOX,OAHAE,EAAoBL,GAAUI,EAAQA,EAAOD,QAASJ,GAG/CK,EAAOD,OACf,C,2BCtBA,MAAM,EAA+BG,ICA/B,EAA+BC,ECA/BC,EAAW,EAAAD,EACZE,OAAO,CACRC,gBAAiB,EAAAH,EAAEI,UAAUC,SAAQ,KAEpCC,SAAS,CAAC,GACFC,EAAmB,EAAY,WAAY,KACpD,MAAMC,GAAW,IAAAC,KAAIR,EAASS,MAAMC,aAAa,CAAEC,KAAM,SAAUC,UAAWC,kBAI9E,OAHA,IAAAC,OAAMP,EAAUQ,IACZC,wBAAwB,EAAMD,GAAe,CAAEJ,KAAM,SAAUC,UAAWC,iBAC3E,CAAEI,WAAW,EAAMC,MAAM,IACrB,CACHX,cCTFY,EAAa,CAAEC,MAAO,8BACtBC,EAAa,CAAED,MAAO,iBACtBE,EAAa,CAAEF,MAAO,yBACtBG,EAAa,CAAEH,MAAO,0CCA5B,GDG6B,qBAAiB,CAC1CI,OAAQ,OACR,KAAAC,CAAMC,GACF,MAAM,SAAEnB,GAAa,EAAYD,KAC3BqB,EAAsB,KACxBjD,OAAOC,QAAQ,SAEnB,MAAO,CAACiD,EAAMC,MACF,kBAAc,wBAAoB,MAAOV,EAAY,EACzD,wBAAoB,MAAOE,EAAY,CACnCQ,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAET,MAAO,6CAA+C,EACzG,wBAAoB,IAAK,MAAM,qBAAiB,UAChD,wBAAoB,MAAO,CAAEA,MAAO,8DACpC,KACJ,wBAAoB,MAAOE,EAAY,EACnC,wBAAoB,MAAO,CAAEF,MAAO,0CAA4C,EAC5E,wBAAoB,QAAS,CACzBA,MAAO,cACPT,KAAM,SACNmB,MAAO,OACPC,QAASJ,OAGjB,wBAAoB,MAAOJ,EAAY,EACnC,qBAAgB,wBAAoB,QAAS,CACzC,sBAAuBM,EAAO,KAAOA,EAAO,GAAMG,IAAa,WAAOzB,GAAyB,gBAAIyB,GACnGrB,KAAM,YACP,KAAM,KAAuB,CAC5B,CAAC,kBAAiB,WAAOJ,GAAUL,mBAEvC2B,EAAO,KAAOA,EAAO,IAAK,wBAAoB,QAAS,CAAEI,IAAK,oBAAqB,qBAAiB,SAAU,MAElHJ,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,CAAET,MAAO,SAAW,MAAO,UAKnG,IE5CEc,GAAM,IAAAC,WAAU,GAAIC,IAAI,KAC9B3D,EAAE,KACE,MAAM4D,EAqBC5D,EAAE,SAAS6D,KAAK,YAAazB,eApBpCpC,EAAE,yBAAyB8D,OAAOF,GAStC,WACI,GAAI5D,EAAE,yBAAyBoC,mBAAmB2B,OAAS,EACvD,OAEJ,MAAMC,EAAOhE,EAAE,SAAS6D,KAAK,YAAazB,eAAe0B,OAAO9D,EAAE,eAAgBiE,UAAUC,SAC5FlE,EAAE,QAAQ8D,OAAOE,EACrB,CAdIG,GACAV,EAAIW,MAAMR,EAAK,MAEnB5D,EAAEH,QAAQM,GAAG,WAAY,KACrBsD,EAAIY,UAYJrE,EAAE,yBAAyBoC,mBAAmBkC,SAM9CtE,EAAE,kBAAkBoC,mBAAmBkC,WC1B3CtE,EAAEuE,UAEqB,IADAC,0BAIbC,mBAAmB,CACrB,CACIC,KAAM,YACNC,QAAS,EAAO,2eAYpB,CACID,KAAM,YACNC,QAAS,EAAO,0eAYrB,CAAEC,QAAS","sources":["src://tavern_helper_template/src/脚本示例/监听聊天文件变更.ts","src://tavern_helper_template/src/脚本示例/加载和卸载时执行函数.ts","src://tavern_helper_template/src/脚本示例/监听消息修改.ts","src://tavern_helper_template/src/脚本示例/添加按钮和注册按钮事件.ts","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/external var \"Vue\"","src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/src/脚本示例/settings.ts","src://tavern_helper_template/src/脚本示例/设置界面.vue","webpack://tavern_helper_template/src/脚本示例/设置界面.vue?edfb","src://tavern_helper_template/src/脚本示例/设置界面.ts","src://tavern_helper_template/src/脚本示例/调整消息楼层.ts"],"sourcesContent":["let chat_id = SillyTavern.getCurrentChatId();\neventOn(tavern_events.CHAT_CHANGED, new_chat_id => {\n  if (chat_id !== new_chat_id) {\n    chat_id = new_chat_id;\n    window.location.reload();\n  }\n});\n","// 在加载脚本时执行某个函数\n$(() => {\n  toastr.success('你已经成功加载示例脚本!', '恭喜你!');\n});\n\n// 在卸载脚本时执行某个函数\n$(window).on('pagehide', () => {\n  toastr.info('你已经卸载示例脚本!', '再见!');\n});\n","eventOn(tavern_events.MESSAGE_UPDATED, (message_id: number) => {\n  toastr.error(`谁让你动我第 ${message_id} 楼消息的😡`, `干什么!`);\n});\n","$(() => {\n  replaceScriptButtons([{ name: '晚上好', visible: true }]);\n\n  eventOn(getButtonEvent('晚上好'), () => {\n    toastr.warning('晚安, 络络');\n  });\n});\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","const __WEBPACK_NAMESPACE_OBJECT__ = z;","const Settings = z\n    .object({\n    button_selected: z.boolean().default(false),\n})\n    .prefault({});\nexport const useSettingsStore = defineStore('settings', () => {\n    const settings = ref(Settings.parse(getVariables({ type: 'script', script_id: getScriptId() })));\n    watch(settings, new_settings => {\n        insertOrAssignVariables(klona(new_settings), { type: 'script', script_id: getScriptId() });\n    }, { immediate: true, deep: true });\n    return {\n        settings,\n    };\n});\n","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, unref as _unref, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"example-extension-settings\" };\nconst _hoisted_2 = { class: \"inline-drawer\" };\nconst _hoisted_3 = { class: \"inline-drawer-content\" };\nconst _hoisted_4 = { class: \"example-extension_block flex-container\" };\nimport { storeToRefs } from 'pinia';\nimport { useSettingsStore } from './settings';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: '设置界面',\n    setup(__props) {\n        const { settings } = storeToRefs(useSettingsStore());\n        const handle_button_click = () => {\n            toastr.success('你好呀!');\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[3] || (_cache[3] = _createElementVNode(\"div\", { class: \"inline-drawer-toggle inline-drawer-header\" }, [\n                        _createElementVNode(\"b\", null, _toDisplayString(`脚本示例`)),\n                        _createElementVNode(\"div\", { class: \"inline-drawer-icon fa-solid fa-circle-chevron-down down\" })\n                    ], -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"div\", { class: \"example-extension_block flex-container\" }, [\n                            _createElementVNode(\"input\", {\n                                class: \"menu_button\",\n                                type: \"submit\",\n                                value: `示例按钮`,\n                                onClick: handle_button_click\n                            })\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _withDirectives(_createElementVNode(\"input\", {\n                                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((_unref(settings).button_selected) = $event)),\n                                type: \"checkbox\"\n                            }, null, 512 /* NEED_PATCH */), [\n                                [_vModelCheckbox, _unref(settings).button_selected]\n                            ]),\n                            _cache[1] || (_cache[1] = _createElementVNode(\"label\", { for: \"example_setting\" }, _toDisplayString(`示例开关`), -1 /* CACHED */))\n                        ]),\n                        _cache[2] || (_cache[2] = _createElementVNode(\"hr\", { class: \"sysHR\" }, null, -1 /* CACHED */))\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./设置界面.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./设置界面.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import 界面 from './设置界面.vue';\nconst app = createApp(界面).use(createPinia());\n$(() => {\n    const $app = createScriptIdDiv();\n    $('#extensions_settings2').append($app);\n    teleportStyle();\n    app.mount($app[0]);\n});\n$(window).on('pagehide', () => {\n    app.unmount();\n    deteleportStyle();\n    destroyScriptIdDiv();\n});\nfunction teleportStyle() {\n    if ($(`head > div[script_id=\"${getScriptId()}\"]`).length > 0) {\n        return;\n    }\n    const $div = $(`<div>`).attr('script_id', getScriptId()).append($(`head > style`, document).clone());\n    $('head').append($div);\n}\nfunction deteleportStyle() {\n    $(`head > div[script_id=\"${getScriptId()}\"]`).remove();\n}\nfunction createScriptIdDiv() {\n    return $('<div>').attr('script_id', getScriptId());\n}\nfunction destroyScriptIdDiv() {\n    $(`div[script_id=\"${getScriptId()}\"]`).remove();\n}\n","\"use strict\";\n$(async () => {\n    const message_id = getLastMessageId();\n    if (message_id !== 0) {\n        return;\n    }\n    await createChatMessages([\n        {\n            role: 'assistant',\n            message: dedent(`\n                   [查看日记: 这是第二次看我的日记了呢~]\n                   <roleplay_options>\n                   接受日记本并翻阅: 青空黎接过她递来的粉色日记本，在天台阳光下缓缓翻开第一页\n                   保持沉默盯着她看: 青空黎没有接本子，只是盯着她略显紧张的表情和轻颤的声音\n                   坐到她身边: 青空黎没有立刻回应，而是缓缓走到络络身边坐下，等待她自己继续说\n                   开玩笑化解气氛: 青空黎微微一笑，开玩笑地说「所以，是要让我当监督官啦？」\n                   跳过时间: 青空黎接过日记本，安静地翻了几页，时间悄然流逝至黄昏深处\n                   和络络聊天: 青空黎试探性地问：「这本是从哪天开始写的？都写些什么呀？」\n                   </roleplay_options>\n                 `),\n        },\n        {\n            role: 'assistant',\n            message: dedent(`\n                   [查看日记: 真是的, 就这么喜欢看吗(v〃ω〃)]\n                   <roleplay_options>\n                   阅读日记第一页：青空黎打开粉色的日记本，从第一页开始认真阅读络络的记录内容。\n                   问她封面上的兔子贴纸：青空黎好奇那枚蓝色兔子贴纸的来历，转头向络络询问。\n                   观察络络的小动作：青空黎不急着翻开日记，而是注意到络络表情里一丝期待与不安。\n                   和她闲聊天气：青空黎随口聊起傍晚风有点凉，试图舒缓紧张气氛。\n                   调侃她：“有哪页是‘不许看’的？”青空黎轻松地试图化解她的小慌乱。\n                   转身回教室：青空黎接过日记却并未立刻翻开，而是表示回教室再看，打算慢慢阅读。\n                   </roleplay_options>\n                 `),\n        },\n    ], { refresh: 'all' });\n});\n"],"names":["chat_id","SillyTavern","getCurrentChatId","eventOn","tavern_events","CHAT_CHANGED","new_chat_id","window","location","reload","$","toastr","success","on","info","MESSAGE_UPDATED","message_id","error","replaceScriptButtons","name","visible","getButtonEvent","warning","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","Vue","z","Settings","object","button_selected","boolean","default","prefault","useSettingsStore","settings","ref","parse","getVariables","type","script_id","getScriptId","watch","new_settings","insertOrAssignVariables","immediate","deep","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","__name","setup","__props","handle_button_click","_ctx","_cache","value","onClick","$event","for","app","createApp","use","$app","attr","append","length","$div","document","clone","teleportStyle","mount","unmount","remove","async","getLastMessageId","createChatMessages","role","message","refresh"],"sourceRoot":""}