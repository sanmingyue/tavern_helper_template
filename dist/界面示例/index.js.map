{"version":3,"file":"index.js","mappings":"mBAIAA,EAAQ,EAAU,CAACC,EAAKC,KACpB,MAAMC,EAASF,EAAIG,WAAaH,EAChC,IAAK,MAAOI,EAAKC,KAAQJ,EACrBC,EAAOE,GAAOC,EAElB,OAAOH,E,WCPXI,EAAE,KACAC,OAAOC,QAAQ,aAAc,UAI/BF,EAAEG,QAAQC,GAAG,WAAY,KACvBH,OAAOI,KAAK,WAAY,Q,GCPtBC,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAahB,QAGrB,IAAIkB,EAASL,EAAyBE,GAAY,CAGjDf,QAAS,CAAC,GAOX,OAHAmB,EAAoBJ,GAAUG,EAAQA,EAAOlB,QAASc,GAG/CI,EAAOlB,OACf,C,OCtBA,MAAM,EAA+BoB,UCA/B,EAA+BC,ICI/BC,EAAa,CAAEC,MAAO,uCAC5B,GAA6B,qBAAiB,CAC1CC,OAAQ,KACR,KAAAC,CAAMC,GACF,MAAMC,GAAe,IAAAC,KAAI,IAgBzB,OAHA,IAAAC,WAAU,MAZV,WAEI,MAAMC,EAAiBC,iBAAiB,YAElCC,EAAaC,sBAEbC,EAAeC,gBAAgBH,GAAY,GAG3CI,EAAO,GAAGN,MADCI,EAAaG,QAAQC,MAAM,yBAAyB,IAAM,KAE3EX,EAAaY,MAAQH,CACzB,CAEII,KAEG,CAACC,EAAMC,MACF,kBAAc,wBAAoB,MAAO,CAC7CnB,MAAO,WACPoB,SAAU,IACVC,QAASF,EAAO,KAAOA,EAAO,GAAMG,GAAYJ,EAAKK,QAAQC,KAAK,UACnE,EACC,wBAAoB,OAAQzB,GAAY,sBAAiB,WAAOK,IAAgB,KAG5F,I,aC3BJ,MAEA,GAFiC,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBCLvE,MAAMqB,EAAS,CAAC,EAKhB,GAFiC,OAAgBA,EAAQ,CAAC,CAAC,SCFpD,SAAgBP,EAAMC,GAC3B,MAAMO,GAAwB,sBAAkB,cAEhD,OAAQ,kBAAc,iBAAaA,EACrC,KCFM,EAAa,CAAE1B,MAAO,oBACtB2B,EAAa,CAAE3B,MAAO,yBACtB4B,EAAa,CAAC,WACdC,EAAa,CAAE7B,MAAO,0BACtB8B,EAAa,CAAE9B,MAAO,4BAC5B,GAA6B,qBAAiB,CAC1CC,OAAQ,MACR,KAAAC,CAAMC,GACF,MAAM4B,GAAQ,IAAA1B,KAAI,IAiBlB,OAPA,IAAAC,WAAU,KACNyB,EAAMf,MAVV,WACI,MAAML,EAAeC,gBAAgBF,uBAAuB,GAG5D,MADqB,KADRC,EAAaG,QAAQC,MAAM,kDAAkD,IAAM,IAClEiB,SAAS,uBACnBC,IAAIlB,IAAS,CAC7BmB,MAAOnB,EAAM,GACboB,QAASpB,EAAM,GAAGqB,QAAQ,eAAgB,MAAMA,QAAQ,WAAY,QAE5E,CAEkBC,KAMX,CAACnB,EAAMC,MACF,kBAAc,wBAAoB,MAAO,EAAY,EACzD,wBAAoB,MAAOQ,EAAY,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,iBAAY,WAAOI,GAASO,KACxE,kBAAc,wBAAoB,MAAO,CAC7CxD,IAAKwD,EAAKJ,MACVlC,MAAO,wBACPoB,SAAU,IACVC,QAAUC,GAZ9BiB,eAA+BD,SACrBE,mBAAmB,CAAC,CAAEC,KAAM,OAAQ3B,QAASwB,EAAKH,WACxDO,aAAa,WACjB,CASyC,CAAiBJ,IACvC,EACC,wBAAoB,OAAQT,EAAY,EACpC,wBAAoB,SAAU,MAAM,qBAAiBS,EAAKJ,OAAQ,KAEtEf,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,CAAEnB,MAAO,uBAAyB,MAAO,KAC7F,wBAAoB,OAAQ8B,GAAY,qBAAiBQ,EAAKH,SAAU,IACzE,EAAeP,KAClB,UAIpB,ICzCJ,GAFiC,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBCFjEe,GAAS,IAAAC,cAAa,CACxBC,SAAS,IAAAC,uBACTC,OAAQ,CACJ,CAAEC,KAAM,MAAOC,UAAW,GAC1B,CAAED,KAAM,OAAQC,UAAW,MAGnCN,EAAOP,QAAQ,OACfpD,EAAE,MACE,IAAAkE,WAAU,GAAKC,IAAIR,GAAQS,MAAM","sources":["src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.22_typescript@6.0.0-dev.20250807__webpack@5.102.1/node_modules/vue-loader/dist/exportHelper.js","src://tavern_helper_template/src/界面示例/加载和卸载时执行函数.ts","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/external var \"VueRouter\"","src://tavern_helper_template/external var \"Vue\"","webpack://tavern_helper_template/./src/界面示例/日记.vue?7baf","webpack://tavern_helper_template/src/界面示例/日记.vue?c22b","webpack://tavern_helper_template/src/界面示例/界面.vue?62f0","src://tavern_helper_template/src/界面示例/界面.vue","webpack://tavern_helper_template/./src/界面示例/选择框.vue?61e9","webpack://tavern_helper_template/src/界面示例/选择框.vue?ec08","src://tavern_helper_template/src/界面示例/界面.ts"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","// 在界面加载好后执行某个函数\n// 注意: 必须使用 `$()` 而不是 `document.addEventListener('DOMContentLoaded'`, 后者会让实时修改失效\n$(() => {\n  toastr.success('你已经成功加载界面!', '恭喜你!');\n});\n\n// 在界面卸载时执行某个函数\n$(window).on('pagehide', () => {\n  toastr.info('你已经卸载界面!', '再见!');\n});\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const __WEBPACK_NAMESPACE_OBJECT__ = VueRouter;","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\n\nimport { ref, onMounted } from 'vue';\nconst _hoisted_1 = { class: \"message-content font-bold underline\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: '日记',\n    setup(__props) {\n        const display_text = ref('');\n        function captureDisplayText() {\n            // 通过 substitudeMacros 我们可以解析酒馆宏\n            const character_name = substitudeMacros('{{char}}');\n            // 通过 getCurrentMessageId 我们可以获取界面所在的楼层号\n            const message_id = getCurrentMessageId();\n            // 通过 getChatMessages 我们可以获取楼层内容\n            const chat_message = getChatMessages(message_id)[0];\n            // 我们可以从楼层的消息中通过正则提取出对话内容, 由于这是在代码中做, 相比起直接用酒馆正则会更加方便: 我们完全可以用其他代码对文本进行更多处理\n            const dialogue = chat_message.message.match(/\\[查看日记[:：]\\s*(.+)\\]/)?.[1] ?? '';\n            const text = `${character_name}: ${dialogue}`;\n            display_text.value = text;\n        }\n        onMounted(() => {\n            captureDisplayText();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: \"clickdiv\",\n                tabindex: \"1\",\n                onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$router.push('/选择框')))\n            }, [\n                _createElementVNode(\"span\", _hoisted_1, _toDisplayString(_unref(display_text)), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./日记.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./日记.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./日记.vue?vue&type=style&index=0&id=13ae5fe7&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.22_typescript@6.0.0-dev.20250807__webpack@5.102.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-13ae5fe7\"]])\n\nexport default __exports__","/* unplugin-vue-components disabled */import { render } from \"./界面.vue?vue&type=template&id=51f52571\"\nconst script = {}\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.22_typescript@6.0.0-dev.20250807__webpack@5.102.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx, _cache) {\n  const _component_RouterView = _resolveComponent(\"RouterView\")\n\n  return (_openBlock(), _createBlock(_component_RouterView))\n}","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\";\n\nimport { ref, onMounted } from 'vue';\nconst _hoisted_1 = { class: \"roleplay_options\" };\nconst _hoisted_2 = { class: \"roleplay_options_back\" };\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"roleplay_options_title\" };\nconst _hoisted_5 = { class: \"roleplay_options_content\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: '选择框',\n    setup(__props) {\n        const items = ref([]);\n        function extractItems() {\n            const chat_message = getChatMessages(getCurrentMessageId())[0];\n            const text = chat_message.message.match(/<roleplay_options>(.*?)<\\/roleplay_options>/s)?.[1] ?? '';\n            const item_matches = [...text.matchAll(/(.+?)[:：]\\s*(.+)/gm)];\n            return item_matches.map(match => ({\n                title: match[1],\n                content: match[2].replace(/^\\$\\{(.+)\\}$/, '$1').replace(/^「(.+)」$/, '$1'),\n            }));\n        }\n        onMounted(() => {\n            items.value = extractItems();\n        });\n        async function handleItemClick(item) {\n            await createChatMessages([{ role: 'user', message: item.content }]);\n            triggerSlash('/trigger');\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(items), (item) => {\n                        return (_openBlock(), _createElementBlock(\"div\", {\n                            key: item.title,\n                            class: \"roleplay_options_item\",\n                            tabindex: \"1\",\n                            onClick: ($event) => (handleItemClick(item))\n                        }, [\n                            _createElementVNode(\"span\", _hoisted_4, [\n                                _createElementVNode(\"strong\", null, _toDisplayString(item.title), 1 /* TEXT */)\n                            ]),\n                            _cache[0] || (_cache[0] = _createElementVNode(\"hr\", { class: \"roleplay_options_hr\" }, null, -1 /* CACHED */)),\n                            _createElementVNode(\"span\", _hoisted_5, _toDisplayString(item.content), 1 /* TEXT */)\n                        ], 8 /* PROPS */, _hoisted_3));\n                    }), 128 /* KEYED_FRAGMENT */))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./选择框.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./选择框.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./选择框.vue?vue&type=style&index=0&id=71ee741c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.22_typescript@6.0.0-dev.20250807__webpack@5.102.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-71ee741c\"]])\n\nexport default __exports__","import { createMemoryHistory, createRouter } from 'vue-router';\nimport Diary from './日记.vue';\nimport App from './界面.vue';\nimport RoleplayOptions from './选择框.vue';\nconst router = createRouter({\n    history: createMemoryHistory(),\n    routes: [\n        { path: '/日记', component: Diary },\n        { path: '/选择框', component: RoleplayOptions },\n    ],\n});\nrouter.replace('/日记');\n$(() => {\n    createApp(App).use(router).mount('#app');\n});\n"],"names":["exports","sfc","props","target","__vccOpts","key","val","$","toastr","success","window","on","info","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","module","__webpack_modules__","VueRouter","Vue","_hoisted_1","class","__name","setup","__props","display_text","ref","onMounted","character_name","substitudeMacros","message_id","getCurrentMessageId","chat_message","getChatMessages","text","message","match","value","captureDisplayText","_ctx","_cache","tabindex","onClick","$event","$router","push","script","_component_RouterView","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","items","matchAll","map","title","content","replace","extractItems","item","async","createChatMessages","role","triggerSlash","router","createRouter","history","createMemoryHistory","routes","path","component","createApp","use","mount"],"sourceRoot":""}